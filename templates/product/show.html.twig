{% extends 'base.html.twig' %}

{% block title %}{{ product.name }} - {{ product.category.name | capitalize }}{% endblock %}

{% block body %}
<main class="main-product">
    {% include "partials/breadcrumb.html.twig" %}
    <div class="product-container">
        <article class="product-content">
            <section class="product-content-details">
                <div class="page-product-image">
                    {% for image in product.images %}
                        <img src="{{ asset(image.image) }}" alt="Image de {{ product.name }}">
                    {% endfor %}
                </div>
                <div class="product-content-details-header">
                    <h1 class="page-product-name">
                        {{ product.name }}
                    </h1>
                    <span class="page-product-price">
                    {{ product.price }} € 
                    </span>
                    <span class="page-product-date">
                    {{ product.createdAt | date("d/m/Y \\à\\ H:i") }} 
                    </span>
                </div>
                <div class="product-page-middle-box">
                    <h2 class="page-product-middle-title">Description</h2>
                    <p class="page-product-description">
                        {{ product.description }} 
                    </p>
                </div>
                <div class="product-page-middle-box">
                    <h2 class="page-product-middle-title">Critères</h2>
                    <div class="page-product-criteria">
                        TODO
                    </div>
                </div>
            </section>
            <section class="product-content-related">
                <div class="seller-more-content product-page-middle-box">
                    <div class="seller-more-content-header">
                        <img src="{{ asset(product.seller.image) }}" alt="Avatar de {{ product.seller.username }}" class="product-page-seller-avatar">
                        <div class="seller-more-content-infos">
                            <span class="seller-username">{{ product.seller.username }}</span>
                            {% if product.seller.soldProducts | length > 1 %}
                                <span class="seller-sold-products">{{ product.seller.soldProducts | length }} annonces</span> 
                            {% endif %}
                        </div>
                    </div>
                    <div class="seller-more-sold-products">
                        <h3 class="seller-other-sold-products">
                            Les annonces de {{ product.seller.username }}
                        </h3>
                        <div class="product-page-other-seller-products">
                            {% for soldProduct in product.seller.soldProducts %}
                                {% if product.id != soldProduct.id %}
                                    <a href="{{ path('app_product_show', {'id': product.id}) }}">
                                        <div class="product-item page-product-item">
                                            <div class="product-main">
                                                <div class="page-product-other-seller-product-image">
                                                    <img src={{ soldProduct.firstImage }} alt="Image de l'annonce : {{ product.name }}">
                                                </div>
                                                <h2 class="product-title">{{ soldProduct.name }}</h2>
                                            </div>
                                            <div class="product-price">{{ soldProduct.price }} €</div>
                                        </div>
                                    </a>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="product-page-related-products product-page-middle-box">
                    <h2 class="page-product-middle-title">Ces annonces peuvent vous intéresser</h2>
                    <div>TODO related products</div>
                </div>
            </section>
            <aside class="seller-aside">
                <div class="seller-card">
                    <div class="seller-card-header">
                        <img src="{{ asset(product.seller.image) }}" alt="Avatar de {{ product.seller.username }}" class="product-page-seller-avatar">
                        <div class="seller-infos">
                            <span class="seller-username">{{ product.seller.username }}</span>
                            {% if product.seller.soldProducts | length > 1 %}
                                <span class="seller-sold-products">{{ product.seller.soldProducts | length }} annonces</span> 
                            {% endif %}
                        </div>
                    </div>
                    <div class="seller-buttons">
                        <button class="seller-button-buy">Acheter</button>
                        <button class="seller-button-chat">Message</button>
                    </div>
                </div>
            </aside>
        </article>
    </div>
    <!-- <a href="{{ path('app_product_index') }}">back to list</a> -->
    <!-- <a href="{{ path('app_product_edit', {'id': product.id}) }}">edit</a> -->
    <!-- {{ include('product/_delete_form.html.twig') }} -->
</main>
{% endblock %}
